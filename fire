import { initializeApp } from "firebase/app";
import { getMessaging, getToken, onMessage } from "firebase/messaging";

// ⚠️ Substitua pelos dados que você copiou do passo 5 acima
const firebaseConfig = {
    apiKey: process.env.REACT_APP_FIREBASE_API_KEY,
    authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,
@@ -11,32 +11,100 @@ const firebaseConfig = {
    appId: process.env.REACT_APP_FIREBASE_APP_ID
};


const app = initializeApp(firebaseConfig);
const messaging = getMessaging(app);

export const getFirebaseToken = async () => {

        const token = await getToken(messaging, {
            vapidKey: process.env.REACT_APP_FIREBASE_VAPID_KEY

        });

        if (token) {
            return token;
        } else {
            console.warn('Nenhum token de registro disponível. Solicite permissão.');
            return null;
        }
    } catch (err) {
        console.error('Erro ao obter token Firebase:', err);

        return null;
    }
};

// Listener para mensagens quando o app está aberto (foreground)
export const onMessageListener = () =>
    new Promise((resolve) => {
        onMessage(messaging, (payload) => {
            alert('chegou aki')
            resolve(payload);
        });
    });
